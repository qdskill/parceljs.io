<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ğŸ“š API</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link type="text/css" rel="stylesheet" href="assets/style.css" />
  <link type="text/css" rel="stylesheet" href="assets/pilcrow.css" />
  <link type="text/css" rel="stylesheet" href="assets/hljs-github.min.css"/>
  <!--<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110647385-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-110647385-1');
  </script>-->
  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?6b5f065a80e0af3ff54139cf0ae94d47";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
  </script>    
</head>
<body>
  <header>
    <a class="logo" href="/">
      <img class="parcel" src="assets/parcel.png" srcset="assets/parcel@2x.png 2x, assets/parcel@3x.png 3x" height="30">
      <img class="type" src="assets/logo.svg" alt="Parcel">
    </a>
    <div class="links">
      <a href="https://github.com/parcel-bundler/parcel" target="_blank">GitHub</a>
    </div>
  </header>
  <div class="content">
    <nav>
      <ul>
        <li><a href="getting_started.html">ğŸš€ å¿«é€Ÿå¼€å§‹</a></li>
        <li><a href="assets.html">ğŸ“¦ èµ„æº</a></li>
        <li><a href="transforms.html">ğŸ  è½¬æ¢</a></li>
        <li><a href="code_splitting.html">âœ‚ï¸ ä»£ç æ‹†åˆ†</a></li>
        <li><a href="hmr.html">ğŸ”¥ çƒ­æ¨¡å—é‡è½½</a></li>
        <li><a href="production.html">âœ¨ ç”Ÿäº§ç¯å¢ƒ</a></li>
        <li><a href="recipes.html">ğŸ° é…æ–¹</a></li>
      </ul>
      <h3>è¿›é˜¶</h3>
      <ul>
        <li><a href="how_it_works.html">ğŸ›  å®ƒå¦‚ä½•è¿ä½œ</a></li>
        <li><a href="asset_types.html">ğŸ“ èµ„æºç±»å‹</a></li>
        <li><a href="api.html">ğŸ“š API</a></li>
        <li><a href="packagers.html">ğŸ“¦ Packagers</a></li>
        <li><a href="plugins.html">ğŸ”Œ æ’ä»¶</a></li>
      </ul>
    </nav>
    <main><h1 id="ğŸ“š-api"><a class="header-link" href="#ğŸ“š-api"></a>ğŸ“š API</h1>
<h2 id="bundler"><a class="header-link" href="#bundler"></a>Bundler</h2>
<p>ä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨ API æ›¿ä»£ CLI æ¥åˆå§‹åŒ– bunlder ï¼Œè·å–æ›´é«˜çº§çš„ä½¿ç”¨æ–¹å¼(ä¾‹å¦‚: åœ¨æ¯æ¬¡æ„å»ºåè¿›è¡Œè‡ªå®šä¹‰æ“ä½œ)ã€‚
é’ˆå¯¹æ¯ä¸ªé€‰é¡¹éƒ½ç»™å‡ºäº†å¯å‚è€ƒçš„ç¤ºä¾‹è¿›è¡Œè¯´æ˜:</p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> Bundler = <span class="hljs-built_in">require</span>(<span class="hljs-string">'parcel-bundler'</span>);
<span class="hljs-keyword">const</span> Path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-comment">// å…¥å£æ–‡ä»¶è·¯å¾„</span>
<span class="hljs-keyword">const</span> file = Path.join(__dirname, <span class="hljs-string">'./index.html'</span>);

<span class="hljs-comment">// Bundler é€‰é¡¹</span>
<span class="hljs-keyword">const</span> options = {
  <span class="hljs-attr">outDir</span>: <span class="hljs-string">'./dist'</span>, <span class="hljs-comment">// å°†ç”Ÿæˆçš„æ–‡ä»¶æ”¾å…¥è¾“å‡ºç›®å½•ä¸‹ï¼Œé»˜è®¤ä¸º dist</span>
  outFile: <span class="hljs-string">'index.html'</span>, <span class="hljs-comment">// è¾“å‡ºæ–‡ä»¶çš„åç§°</span>
  publicUrl: <span class="hljs-string">'./'</span>, <span class="hljs-comment">// é™æ€èµ„æºçš„ url ï¼Œé»˜è®¤ä¸º dist</span>
  watch: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦éœ€è¦ç›‘å¬æ–‡ä»¶å¹¶åœ¨å‘ç”Ÿæ”¹å˜æ—¶é‡æ–°ç¼–è¯‘å®ƒä»¬ï¼Œé»˜è®¤ä¸º process.env.NODE_ENV !== 'production'</span>
  cache: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å¯ç”¨æˆ–ç¦ç”¨ç¼“å­˜ï¼Œé»˜è®¤ä¸º true</span>
  cacheDir: <span class="hljs-string">'.cache'</span>, <span class="hljs-comment">// ç¼“å­˜è¢«æ”¾å…¥çš„ç›®å½•ï¼Œé»˜è®¤ä¸º .cache</span>
  minify: <span class="hljs-literal">false</span>, <span class="hljs-comment">// å‹ç¼©æ–‡ä»¶ï¼Œå½“ process.env.NODE_ENV === 'production' æ—¶ï¼Œè¢«å¯ç”¨ã€‚</span>
  target: <span class="hljs-string">'browser'</span>, <span class="hljs-comment">// æµè§ˆå™¨/node/electron, é»˜è®¤ä¸º browser</span>
  https: <span class="hljs-literal">false</span>, <span class="hljs-comment">// æœåŠ¡å™¨æ–‡ä»¶ä½¿ç”¨ https æˆ–è€… httpï¼Œé»˜è®¤ä¸º false</span>
  logLevel: <span class="hljs-number">3</span>, <span class="hljs-comment">// 3 = è¾“å‡ºæ‰€æœ‰å†…å®¹ï¼Œ2 = è¾“å‡ºè­¦å‘Šå’Œé”™è¯¯, 1 = è¾“å‡ºé”™è¯¯</span>
  hmrPort: <span class="hljs-number">0</span>, <span class="hljs-comment">// hmr socket è¿è¡Œçš„ç«¯å£ï¼Œé»˜è®¤ä¸ºéšæœºç©ºé—²çš„ç«¯å£ (node.js ä¸­çš„ 0 è¢«è§£æä¸ºéšæœºç©ºé—²ç«¯å£)</span>
  sourceMaps: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å¯ç”¨æˆ–ç¦ç”¨ sourcemapsï¼Œé»˜è®¤ä¸ºå¯ç”¨(åœ¨ç²¾ç®€ç‰ˆæœ¬ä¸­ä¸æ”¯æŒ)</span>
  hmrHostname: <span class="hljs-string">''</span>, <span class="hljs-comment">// çƒ­æ¨¡å—é‡è½½çš„ä¸»æœºåï¼Œé»˜è®¤ä¸º ''</span>
  detailedReport: <span class="hljs-literal">false</span> <span class="hljs-comment">// æ‰“å° bundles ï¼Œèµ„æºï¼Œæ–‡ä»¶å¤§å°ä»¥åŠæ—¶é—´çš„è¯¦ç»†æŠ¥å‘Šï¼Œé»˜è®¤ä¸º false ï¼Œåªæœ‰åœ¨ç¦ç”¨ç›‘å¬æ—¶æ‰æ‰“å°æŠ¥å‘Š</span>
};

<span class="hljs-comment">// ä½¿ç”¨æä¾›çš„å…¥å£æ–‡ä»¶è·¯å¾„å’Œé€‰é¡¹åˆå§‹åŒ– bundler</span>
<span class="hljs-keyword">const</span> bundler = <span class="hljs-keyword">new</span> Bundler(file, options);

<span class="hljs-comment">// è¿è¡Œ bundlerï¼Œè¿™å°†è¿”å›ä¸» bundle</span>
<span class="hljs-comment">// å¦‚æœä½ ä½¿ç”¨ç›‘å¬æ¨¡å¼ï¼Œè¯·ä½¿ç”¨è¿™äº›äº‹ä»¶ï¼Œå› ä¸ºè¯¥ promise åªä¼šè§¦å‘ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡é‡æ–°æ„å»º</span>
<span class="hljs-keyword">const</span> bundle = <span class="hljs-keyword">await</span> bundler.bundle();</code></pre><h3 id="äº‹ä»¶"><a class="header-link" href="#äº‹ä»¶"></a>äº‹ä»¶</h3>
<p>è¿™æ˜¯ bundler æ‰€æœ‰çš„äº‹ä»¶åˆ—è¡¨ã€‚</p>
<ul class="list">
<li><p>ä¸€æ—¦ parcel å®Œæˆæ„å»ºï¼Œ<code>bundled</code> ä¼šè¢«è°ƒç”¨ï¼Œä¸» <a href="#bundle">bundle</a> ä¼šä½œä¸ºå‚æ•°ä¼ é€’åˆ°è¯¥ callback</p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> bundle = <span class="hljs-keyword">new</span> Bundler(...);
bundle.on(<span class="hljs-string">'bundled'</span>, (bundle) =&gt; {
<span class="hljs-comment">// bundle åŒ…å«æ‰€æœ‰èµ„æºå’Œ bundleï¼Œå¦‚éœ€äº†è§£æ›´å¤šè¯·æŸ¥çœ‹æ–‡æ¡£</span>
});</code></pre></li>
<li><p>æ„å»ºç»“æŸå <code>buildEnd</code> ä¼šè¢«è°ƒç”¨ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯å®ƒä¹Ÿä¼šè¢«è§¦å‘</p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> bundle = <span class="hljs-keyword">new</span> Bundler(...);
bundle.on(<span class="hljs-string">'buildEnd'</span>, () =&gt; {
<span class="hljs-comment">// åšä»»ä½•äº‹...</span>
});</code></pre></li>
</ul>
<h3 id="bundle"><a class="header-link" href="#bundle"></a>Bundle</h3>
<p><code>Bundle</code> æ˜¯ parcel ç”¨æ¥å°†èµ„æºæ†ç»‘åœ¨ä¸€èµ·çš„å·¥å…·ï¼Œå®ƒè¿˜åŒ…å«èƒ½å¤Ÿæ„å»º bundle æ ‘çš„å­ bundle å’Œå…„å¼Ÿ bundleã€‚</p>
<h4 id="å±æ€§"><a class="header-link" href="#å±æ€§"></a>å±æ€§</h4>
<ul class="list">
<li><code>type</code>: å®ƒåŒ…å«çš„èµ„æºç±»å‹ (ä¾‹å¦‚: js, css, map, ...)</li>
<li><code>name</code>: bundle çš„åç§° (ä½¿ç”¨ <code>entryAsset</code> çš„ <code>Asset.generateBundleName()</code> ç”Ÿæˆ)</li>
<li><code>parentBundle</code>: çˆ¶ bundle ï¼Œåœ¨å…¥å£ bundle ä¸‹ä¸º null</li>
<li><code>entryAsset</code>: bundle çš„å…¥å£ï¼Œç”¨äºç”Ÿæˆåç§°å’Œæ”¶é›†èµ„æº</li>
<li><code>assets</code>: bundle ä¸­æ‰€æœ‰èµ„æºçš„<code>é›†åˆ</code></li>
<li><code>childBundles</code>: æ‰€æœ‰å­ bundle çš„<code>é›†åˆ</code></li>
<li><code>siblingBundles</code>: æ‰€æœ‰å…„å¼Ÿ bundle çš„<code>é›†åˆ</code></li>
<li><code>siblingBundlesMap</code>: æ‰€æœ‰å…„å¼Ÿ bundle çš„æ˜ å°„ <code>Map&lt;String(Type: js, css, map, ...), Bundle&gt;</code></li>
<li><code>offsets</code>: æ‰€æœ‰ bundle ä¸­èµ„æºä½ç½®çš„æ˜ å°„ <code>Map&lt;Asset, number(line number inside the bundle)&gt;</code> ï¼Œç”¨äºç”Ÿæˆå‡†ç¡®çš„ sourcemap ã€‚</li>
</ul>
<h4 id="æ ‘"><a class="header-link" href="#æ ‘"></a>æ ‘</h4>
<p><code>Bundle</code> åŒ…å«ä¸€ä¸ª <code>parentBundle</code>ï¼Œ<code>childBundles</code> å’Œ <code>siblingBundles</code>ï¼Œæ‰€æœ‰è¿™äº›å±æ€§ä¸€èµ·åˆ›å»ºä¸€ä¸ªå¿«é€Ÿè¿­ä»£çš„ bundle æ ‘ã€‚</p>
<p>èµ„æºæ ‘åŠå…¶ç”Ÿæˆçš„ bundle æ ‘çš„åŸºæœ¬ç¤ºä¾‹å¦‚ä¸‹:</p>
<h5 id="èµ„æºæ ‘:"><a class="header-link" href="#èµ„æºæ ‘:"></a>èµ„æºæ ‘:</h5>
<p><code>index.html</code> å¼•ç”¨ <code>index.js</code> å’Œ <code>index.css</code></p>
<p><code>index.js</code> å¼•ç”¨ <code>test.js</code> å’Œ <code>test.txt</code></p>
<pre class="hljs"><code>index.html
<span class="hljs-comment">-- index.js</span>
 |<span class="hljs-comment">--- test.js</span>
 |<span class="hljs-comment">--- test.txt</span>
<span class="hljs-comment">-- index.css</span></code></pre><h5 id="bundle-æ ‘:"><a class="header-link" href="#bundle-æ ‘:"></a>Bundle æ ‘:</h5>
<p><code>index.html</code> è¢«ä½œä¸ºä¸» bundle çš„å…¥å£èµ„æºï¼Œè¿™ä¸ªä¸» bundle åˆ›å»ºäº†ä¸¤ä¸ªå­ bundle ï¼Œä¸€ä¸ªç”¨äº <code>index.js</code>ï¼Œå¦ä¸€ä¸ªç”¨äº <code>index.css</code> ï¼Œè¿™æ˜¯å› ä¸ºå®ƒä»¬çš„ç±»å‹ä¸åŒäº <code>html</code> ã€‚</p>
<p><code>index.js</code> å¼•å…¥äº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œ<code>test.js</code> å’Œ <code>test.txt</code> ã€‚</p>
<p><code>test.js</code> è¢«æ·»åŠ åˆ°äº† <code>index.js</code> bundle çš„èµ„æºä¸­ï¼Œå› ä¸ºå®ƒä¸ <code>index.js</code> çš„ç±»å‹ç›¸åŒã€‚</p>
<p><code>test.txt</code> ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ bundle ï¼Œå¹¶è¢«æ·»åŠ åˆ° <code>index.js</code> bundle çš„å­å…ƒç´ ä¸­ï¼Œå› ä¸ºå®ƒæ˜¯ä¸ <code>index.js</code> ä¸åŒçš„èµ„æºç±»å‹ã€‚</p>
<p><code>index.css</code> ä¸åŒ…å«å¼•ç”¨ï¼Œå› æ­¤åªåŒ…å«å®ƒçš„å…¥å£èµ„æºã€‚</p>
<p><code>index.css</code> å’Œ <code>index.js</code> çš„ bundle å½¼æ­¤äº’ä¸ºå…±äº«ç›¸åŒçˆ¶çº§çš„å…„å¼Ÿ bundle ã€‚</p>
<pre class="hljs"><code><span class="hljs-keyword">index</span>.html
-- <span class="hljs-keyword">index</span>.js (includes <span class="hljs-keyword">index</span>.js <span class="hljs-keyword">and</span> test.js)
 |--- test.txt (includes test.txt)
-- <span class="hljs-keyword">index</span>.css (includes <span class="hljs-keyword">index</span>.css)</code></pre><h3 id="ä¸­é—´ä»¶(middleware)"><a class="header-link" href="#ä¸­é—´ä»¶(middleware)"></a>ä¸­é—´ä»¶(Middleware)</h3>
<p>ä¸­é—´ä»¶å¯ä»¥ç”¨äº hook åˆ° http æœåŠ¡å™¨(ä¾‹å¦‚: <code>express</code> æˆ–è€… node <code>http</code>) ã€‚</p>
<p>express ä½¿ç”¨ parcel ä¸­é—´ä»¶çš„ç¤ºä¾‹ï¼š</p>
<pre class="hljs"><code><span class="hljs-keyword">const</span> Bundler = <span class="hljs-built_in">require</span>(<span class="hljs-string">'parcel-bundler'</span>);
<span class="hljs-keyword">const</span> app = <span class="hljs-built_in">require</span>(<span class="hljs-string">'express'</span>)();

<span class="hljs-comment">// ä½¿ç”¨æ–‡ä»¶å’Œé€‰é¡¹åˆå§‹åŒ–æ–°çš„ bundler (æœ‰å…³é€‰é¡¹å’Œæ–‡ä»¶çš„å†…å®¹ï¼Œè¯·å‚é˜… bundler æ–‡æ¡£)</span>
<span class="hljs-keyword">const</span> bundler = <span class="hljs-keyword">new</span> Bundler(file, options);

<span class="hljs-comment">// è®© express ä½¿ç”¨ bundler ä¸­é—´ä»¶ï¼Œè¿™å°†è®© parcel å¤„ç†ä½  express æœåŠ¡å™¨ä¸Šçš„æ¯ä¸ªè¯·æ±‚</span>
app.use(bundler.middleware());

<span class="hljs-comment">// ç›‘å¬ç«¯å£ 8080</span>
app.listen(<span class="hljs-number">8080</span>);</code></pre>    </main>
  </div>
  <script>
    (function () {
      var activeLink = Array.from(document.querySelectorAll('nav a')).find(function (a) {
        return a.href === window.location.href;
      });

      activeLink.classList.add('selected');
    })();
  </script>
</body>
</html>
